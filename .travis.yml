language: python

sudo: required
dist: xenial

python:
 - "3.6"

services:
  - docker

before_install:
 - sed -i "s/KEY/$DISCORD_TOKEN/g" config/config.ini

install:
 - pip install poetry
 - poetry install

script:
  - docker build -t canary:latest .
  - docker run -d -v $(pwd):/mnt/canary canary:latest > ./container.tmp
  - sleep 5
  - docker stop $(cat ./container.tmp)
  - docker run -v $(pwd):/mnt/canary canary:latest yapf --diff --recursive .

notifications:
 email: false
